---
title: "Homework 4, Prioritizing Potential Aquaculture"
author: "Eva Newby"
format: html
editor: visual
editor_options: 
  chunk_output_type: console
---
## Link to Homework 4 Description: https://eds-223-geospatial.github.io/assignments/HW4.html 

Species of choice- Common cuttlefish (Sepia officinalis)
https://www.sealifebase.ca/summary/Sepia-officinalis.html

```{r}
# Load Packages
library(tidyverse)
library(stars)
library(tmap)
library(sf)
library(here)
library(terra)
```

## Prepare Data

```{r}
# Read in shapefile for the West Coast EEZ
wc_regions <- st_read(here("data", "wc_regions_clean[1].shp"))
```

```{r}
# Read in bathymetry raster
depth <- terra::rast(here("data", "depth[1].tif"))
```

```{r}
# Read in SST rasters
# Create list of all SST .tif files 
sst_path = here("data")

sst_files <- list.files(sst_path, 
                        pattern = glob2rx("*average_annual_sst_*.tif$"),
                        full.names = TRUE)
# Create a raster stack 
sst <- terra::rast(sst_files) 
```

```{r}
# Check CRS' and transform to match
print(st_crs(depth))
print(st_crs(wc_regions))
print(st_crs(sst))

# Transform sst into EPSG:4326
sst <-project(sst, "EPSG:4326")

# Verify change
print(st_crs(sst))

st_crs(sst) == st_crs(depth)
```

## Process data

```{r}
# Find the mean SST from 2008-2012 (e.g. create single raster of average SST)

```

```{r}
# Convert average SST from Kelvin to Celsius (hint: subtract by 273.15)

```

```{r}
# Crop depth raster to match the extent of the SST raster

```

```{r}
# note: the resolutions of the SST and depth data do not match
# Resample the depth data to match the resolution of the SST data using the nearest neighbor approach

```

```{r}
# Check that the depth and SST match in resolution, extent, and coordinate reference system (hint: can the rasters be stacked?)

```

### Find suitable locations

```{r}
# reclassify SST and depth data into locations that are suitable for oysters (hint: set suitable values to 1 and unsuitable values to 0)

```

```{r}
# Find locations that satisfy both SST and depth conditions
# HINT: The SST and depth rasters should now identify the suitability of locations as 0 or 1. To find locations that have both suitable temperature and depth, you can use map algebra. One idea is to multiple the values of the cells, using the lapp() function.


```

### Determine the most suitable EEZ

```{r}
# Select suitable cells within West Coast EEZs

```

```{r}
# Find area of grid cells

```

```{r}
# Find the total suitable area within each EEZ (hint: it might be helpful to rasterize the EEZ data)

```

